{"ast":null,"code":"var _jsxFileName = \"/Users/fmparantean/Documents/dataviz_project/src/DateHistogram/index.js\",\n  _s = $RefreshSig$();\nimport { scaleLinear, scaleBand, max, brushX, select, min } from 'd3';\nimport { useRef, useEffect } from 'react';\nimport { AxisBottom } from './AxisBottom';\nimport { AxisLeft } from './AxisLeft';\nimport { Marks } from './Marks';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst margin = {\n  top: 20,\n  right: 2,\n  bottom: 50,\n  left: 90\n};\nexport const DateHistogram = ({\n  data,\n  width,\n  height,\n  setBrushExtent,\n  yValueField\n}) => {\n  _s();\n  const innerHeight = height - margin.top - margin.bottom;\n  const innerWidth = width - margin.left - margin.right;\n  const xScale = scaleBand().domain([\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]).range([0, innerWidth]).padding(0.1);\n\n  // Define a function to get the Y value\n  const yValue = d => d[yValueField];\n\n  // Filter out data with invalid Y values (null or equal to 0.00)\n  const filteredData = data.filter(d => d[yValueField] != null && d[yValueField] !== 0);\n  const yScale = scaleLinear().domain([min(filteredData, yValue), max(filteredData, yValue)]) // Ensure max returns a number\n  .range([innerHeight, 0]).nice();\n  const brushRef = useRef();\n  const initialBrushSet = useRef(false); // Track if the initial brush has been set\n\n  useEffect(() => {\n    const brush = brushX().extent([[0, 0], [innerWidth, innerHeight]]).on('brush end', event => {\n      const selection = event.selection;\n      if (!selection) return;\n\n      // Get the selected days based on the current brush position\n      const selectedDays = xScale.domain().filter(day => {\n        const dayPosition = xScale(day);\n        return dayPosition >= selection[0] && dayPosition <= selection[1];\n      });\n      setBrushExtent(selectedDays);\n    });\n    brush(select(brushRef.current));\n\n    // Style the brush handle\n    select(brushRef.current).selectAll('.handle').attr('fill', 'rgba(6, 1, 38, 0.3)');\n    select(brushRef.current).selectAll(\".selection\").attr('fill', 'rgba(30, 64, 186, 0.46)');\n\n    // Set the initial brush position only once\n    if (!initialBrushSet.current) {\n      const initialSelection = [0, innerWidth / 2]; // Selecting the first half\n      brush.move(select(brushRef.current), initialSelection);\n\n      // Automatically select data points based on the initial brush extent\n      const initialSelectedDays = xScale.domain().filter(day => {\n        const dayPosition = xScale(day);\n        return dayPosition >= initialSelection[0] && dayPosition <= initialSelection[1];\n      });\n      setBrushExtent(initialSelectedDays);\n      initialBrushSet.current = true; // Mark that the initial brush has been set\n    }\n  }, [height, innerHeight, innerWidth, setBrushExtent, xScale]); // Include necessary dependencies\n\n  const getYAxisLabel = field => {\n    switch (field) {\n      case 'HR_mad_filtered':\n        return 'HR Mad Score';\n      case 'HRV':\n        return 'HRV Score';\n      case 'stress_xs':\n        return 'Stress Score';\n      case 'satisfaction_journey_xs':\n        return 'Satisfaction Score';\n      default:\n        return 'Score';\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"rect\", {\n      width: width,\n      height: height,\n      fill: \"white\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"g\", {\n      transform: `translate(${margin.left},${margin.top})`,\n      children: [/*#__PURE__*/_jsxDEV(AxisBottom, {\n        xScale: xScale,\n        innerHeight: innerHeight + 10,\n        tickFormat: d => d\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(AxisLeft, {\n        yScale: yScale,\n        innerWidth: innerWidth\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Marks, {\n        data: filteredData // Use filtered data here\n        ,\n        xScale: xScale,\n        yScale: yScale,\n        xValue: d => d.DayOrder,\n        yValue: yValue,\n        circleRadius: 2.5\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"g\", {\n        ref: brushRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n        className: \"axis-label\",\n        textAnchor: \"middle\",\n        transform: `translate(${innerWidth / 2}, ${innerHeight + 44})`,\n        children: \"Days of the Week\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"text\", {\n        className: \"axis-label\",\n        textAnchor: \"middle\",\n        transform: `translate(-30, ${innerHeight / 2}) rotate(-90)`,\n        children: getYAxisLabel(yValueField)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s(DateHistogram, \"GMBx9dGO+yfx/JChWJVsrna+vdk=\");\n_c = DateHistogram;\nvar _c;\n$RefreshReg$(_c, \"DateHistogram\");","map":{"version":3,"names":["scaleLinear","scaleBand","max","brushX","select","min","useRef","useEffect","AxisBottom","AxisLeft","Marks","jsxDEV","_jsxDEV","Fragment","_Fragment","margin","top","right","bottom","left","DateHistogram","data","width","height","setBrushExtent","yValueField","_s","innerHeight","innerWidth","xScale","domain","range","padding","yValue","d","filteredData","filter","yScale","nice","brushRef","initialBrushSet","brush","extent","on","event","selection","selectedDays","day","dayPosition","current","selectAll","attr","initialSelection","move","initialSelectedDays","getYAxisLabel","field","children","fill","fileName","_jsxFileName","lineNumber","columnNumber","transform","tickFormat","xValue","DayOrder","circleRadius","ref","className","textAnchor","_c","$RefreshReg$"],"sources":["/Users/fmparantean/Documents/dataviz_project/src/DateHistogram/index.js"],"sourcesContent":["import {\n    scaleLinear,\n    scaleBand,\n    max,\n    brushX,\n    select,\n    min\n} from 'd3';\nimport { useRef, useEffect } from 'react';\nimport { AxisBottom } from './AxisBottom';\nimport { AxisLeft } from './AxisLeft';\nimport { Marks } from './Marks';\n\nconst margin = { top: 20, right: 2, bottom: 50, left: 90 };\n\nexport const DateHistogram = ({\n    data,\n    width,\n    height,\n    setBrushExtent,\n    yValueField\n}) => {\n    const innerHeight = height - margin.top - margin.bottom;\n    const innerWidth = width - margin.left - margin.right;\n\n    const xScale = scaleBand()\n        .domain([\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"])\n        .range([0, innerWidth])\n        .padding(0.1);\n\n    // Define a function to get the Y value\n    const yValue = d => d[yValueField];\n\n    // Filter out data with invalid Y values (null or equal to 0.00)\n    const filteredData = data.filter(d => d[yValueField] != null && d[yValueField] !== 0);\n\n    const yScale = scaleLinear()\n        .domain([min(filteredData, yValue), max(filteredData, yValue)]) // Ensure max returns a number\n        .range([innerHeight, 0])\n        .nice();\n\n    const brushRef = useRef();\n    const initialBrushSet = useRef(false); // Track if the initial brush has been set\n\n    useEffect(() => {\n        const brush = brushX()\n            .extent([[0, 0], [innerWidth, innerHeight]])\n            .on('brush end', (event) => {\n                const selection = event.selection;\n                if (!selection) return;\n\n                // Get the selected days based on the current brush position\n                const selectedDays = xScale.domain().filter(day => {\n                    const dayPosition = xScale(day);\n                    return dayPosition >= selection[0] && dayPosition <= selection[1];\n                });\n\n                setBrushExtent(selectedDays);\n            });\n\n        brush(select(brushRef.current));\n\n        // Style the brush handle\n        select(brushRef.current)\n            .selectAll('.handle')\n            .attr('fill', 'rgba(6, 1, 38, 0.3)') \n\n        select(brushRef.current)\n            .selectAll(\".selection\")\n            .attr('fill', 'rgba(30, 64, 186, 0.46)') \n           \n            \n        // Set the initial brush position only once\n        if (!initialBrushSet.current) {\n            const initialSelection = [0, innerWidth / 2]; // Selecting the first half\n            brush.move(select(brushRef.current), initialSelection);\n\n            // Automatically select data points based on the initial brush extent\n            const initialSelectedDays = xScale.domain().filter(day => {\n                const dayPosition = xScale(day);\n                return dayPosition >= initialSelection[0] && dayPosition <= initialSelection[1];\n            });\n            setBrushExtent(initialSelectedDays);\n\n            initialBrushSet.current = true; // Mark that the initial brush has been set\n        }\n    }, [height, innerHeight, innerWidth, setBrushExtent, xScale]); // Include necessary dependencies\n\n    const getYAxisLabel = (field) => {\n        switch (field) {\n            case 'HR_mad_filtered':\n                return 'HR Mad Score';\n            case 'HRV':\n                return 'HRV Score';\n            case 'stress_xs':\n                return 'Stress Score';\n            case 'satisfaction_journey_xs':\n                return 'Satisfaction Score';\n            default:\n                return 'Score';\n        }\n    };\n\n    return (\n        <>\n            <rect width={width} height={height} fill=\"white\" />\n            <g transform={`translate(${margin.left},${margin.top})`}>\n                <AxisBottom\n                    xScale={xScale}\n                    innerHeight={innerHeight + 10}\n                    tickFormat={d => d}\n                />\n                <AxisLeft\n                    yScale={yScale}\n                    innerWidth={innerWidth}\n                />\n                <Marks\n                    data={filteredData} // Use filtered data here\n                    xScale={xScale}\n                    yScale={yScale}\n                    xValue={d => d.DayOrder}  \n                    yValue={yValue}\n                    circleRadius={2.5}\n                />\n                <g ref={brushRef} />\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(${innerWidth / 2}, ${innerHeight + 44})`} \n                >\n                    Days of the Week\n                </text>\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(-30, ${innerHeight / 2}) rotate(-90)`} \n                >\n                    {getYAxisLabel(yValueField)}\n                </text>\n            </g>\n        </>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}