{"ast":null,"code":"import{scaleLinear,scaleBand,max,brushX,select,min}from'd3';import{useRef,useEffect}from'react';import{AxisBottom}from'./AxisBottom';import{AxisLeft}from'./AxisLeft';import{Marks}from'./Marks';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const margin={top:20,right:10,bottom:50,left:90};export const DateHistogram=_ref=>{let{data,width,height,setBrushExtent,yValueField}=_ref;const innerHeight=height-margin.top-margin.bottom;const innerWidth=width-margin.left-margin.right;const xScale=scaleBand().domain([\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]).range([0,innerWidth]).padding(0.1);// Define a function to get the Y value\nconst yValue=d=>d[yValueField];// Filter out data with invalid Y values (null or equal to 0.00)\nconst filteredData=data.filter(d=>d[yValueField]!=null&&d[yValueField]!==0);const yScale=scaleLinear().domain([min(filteredData,yValue),max(filteredData,yValue)])// Ensure max returns a number\n.range([innerHeight,0]).nice();const brushRef=useRef();useEffect(()=>{const brush=brushX().extent([[0,0],[innerWidth,innerHeight]]);brush(select(brushRef.current));brush.on('brush end',event=>{const selection=event.selection;if(!selection)return;const selectedDays=xScale.domain().filter(day=>{const dayPosition=xScale(day);return dayPosition>=selection[0]&&dayPosition<=selection[1];});setBrushExtent(selectedDays);});},[innerWidth,innerHeight,setBrushExtent,xScale]);// Include xScale\nconst getYAxisLabel=field=>{switch(field){case'HR_mad_filtered':return'HR Mad Score';case'HRV':return'HRV Score';case'stress_xs':return'Stress Score';case'satisfaction_journey_xs':return'Satisfaction Score';default:return'Score';}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"rect\",{width:width,height:height,fill:\"white\"}),/*#__PURE__*/_jsxs(\"g\",{transform:`translate(${margin.left},${margin.top})`,children:[/*#__PURE__*/_jsx(AxisBottom,{xScale:xScale,innerHeight:innerHeight+10,tickFormat:d=>d}),/*#__PURE__*/_jsx(AxisLeft,{yScale:yScale,innerWidth:innerWidth}),/*#__PURE__*/_jsx(Marks,{data:filteredData// Use filtered data here\n,xScale:xScale,yScale:yScale,xValue:d=>d.DayOrder,yValue:yValue,circleRadius:2.5}),/*#__PURE__*/_jsx(\"g\",{ref:brushRef}),/*#__PURE__*/_jsx(\"text\",{className:\"axis-label\",textAnchor:\"middle\",transform:`translate(${innerWidth/2}, ${innerHeight+44})`,children:\"Test 3\"}),/*#__PURE__*/_jsx(\"text\",{className:\"axis-label\",textAnchor:\"middle\",transform:`translate(-30, ${innerHeight/2}) rotate(-90)`,children:getYAxisLabel(yValueField)})]})]});};","map":{"version":3,"names":["scaleLinear","scaleBand","max","brushX","select","min","useRef","useEffect","AxisBottom","AxisLeft","Marks","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","margin","top","right","bottom","left","DateHistogram","_ref","data","width","height","setBrushExtent","yValueField","innerHeight","innerWidth","xScale","domain","range","padding","yValue","d","filteredData","filter","yScale","nice","brushRef","brush","extent","current","on","event","selection","selectedDays","day","dayPosition","getYAxisLabel","field","children","fill","transform","tickFormat","xValue","DayOrder","circleRadius","ref","className","textAnchor"],"sources":["/Users/fmparantean/Documents/dataviz_project/src/DateHistogram/index.js"],"sourcesContent":["import {\n    scaleLinear,\n    scaleBand,\n    max,\n    brushX,\n    select,\n    min\n} from 'd3';\nimport { useRef, useEffect } from 'react';\nimport { AxisBottom } from './AxisBottom';\nimport { AxisLeft } from './AxisLeft';\nimport { Marks } from './Marks';\n\nconst margin = { top: 20, right: 10, bottom: 50, left: 90 };\n\nexport const DateHistogram = ({\n    data,\n    width,\n    height,\n    setBrushExtent,\n    yValueField\n}) => {\n    const innerHeight = height - margin.top - margin.bottom;\n    const innerWidth = width - margin.left - margin.right;\n\n    const xScale = scaleBand()\n        .domain([\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"])\n        .range([0, innerWidth])\n        .padding(0.1);\n\n    // Define a function to get the Y value\n    const yValue = d => d[yValueField];\n\n    // Filter out data with invalid Y values (null or equal to 0.00)\n    const filteredData = data.filter(d => d[yValueField] != null && d[yValueField] !== 0);\n\n    const yScale = scaleLinear()\n        .domain([min(filteredData, yValue), max(filteredData, yValue)]) // Ensure max returns a number\n        .range([innerHeight, 0])\n        .nice();\n\n    const brushRef = useRef();\n\n    useEffect(() => {\n        const brush = brushX().extent([[0, 0], [innerWidth, innerHeight]]);\n        brush(select(brushRef.current));\n        \n        brush.on('brush end', (event) => {\n            const selection = event.selection;\n            if (!selection) return;\n\n            const selectedDays = xScale.domain().filter(day => {\n                const dayPosition = xScale(day);\n                return dayPosition >= selection[0] && dayPosition <= selection[1];\n            });\n\n            setBrushExtent(selectedDays); \n        });\n    }, [innerWidth, innerHeight, setBrushExtent, xScale]); // Include xScale\n\n    const getYAxisLabel = (field) => {\n        switch (field) {\n            case 'HR_mad_filtered':\n                return 'HR Mad Score';\n            case 'HRV':\n                return 'HRV Score';\n            case 'stress_xs':\n                return 'Stress Score';\n            case 'satisfaction_journey_xs':\n                return 'Satisfaction Score';\n            default:\n                return 'Score';\n        }\n    };\n\n    return (\n        <>\n            <rect width={width} height={height} fill=\"white\" />\n            <g transform={`translate(${margin.left},${margin.top})`}>\n                <AxisBottom\n                    xScale={xScale}\n                    innerHeight={innerHeight + 10}\n                    tickFormat={d => d}\n                />\n                <AxisLeft\n                    yScale={yScale}\n                    innerWidth={innerWidth}\n                />\n                <Marks\n                    data={filteredData} // Use filtered data here\n                    xScale={xScale}\n                    yScale={yScale}\n                    xValue={d => d.DayOrder}  \n                    yValue={yValue}\n                    circleRadius={2.5}\n                />\n                <g ref={brushRef} />\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(${innerWidth / 2}, ${innerHeight + 44})`} \n                >\n                    Test 3\n                </text>\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(-30, ${innerHeight / 2}) rotate(-90)`} \n                >\n                    {getYAxisLabel(yValueField)}\n                </text>\n            </g>\n        </>\n    );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}