{"ast":null,"code":"import{scaleLinear,scaleBand,max,brushX,select}from'd3';import{useRef,useEffect}from'react';import{AxisBottom}from'./AxisBottom';import{AxisLeft}from'./AxisLeft';import{Marks}from'./Marks';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const margin={top:20,right:60,bottom:50,left:90};export const DateHistogram=_ref=>{let{data,width,height,setBrushExtent}=_ref;const innerHeight=height-margin.top-margin.bottom;const innerWidth=width-margin.left-margin.right;const xScale=scaleBand().domain([\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"]).range([0,innerWidth]).padding(0.1);// Adjust padding as necessary\nconst yValue=d=>d.HRV;// Use HRV for y values\nconst yScale=scaleLinear().domain([-5,max(data,yValue)||200])// Ensure max returns a number\n.range([innerHeight,0]).nice();const brushRef=useRef();useEffect(()=>{const brush=brushX().extent([[0,0],[innerWidth,innerHeight]]);brush(select(brushRef.current));brush.on('brush end',event=>{const selection=event.selection;if(!selection)return;// Get the selected domains based on brush selection\nconst selectedDays=xScale.domain().filter(day=>{const dayPosition=xScale(day);return dayPosition>=selection[0]&&dayPosition<=selection[1];});// Update the brush extent\nsetBrushExtent(selectedDays);});},[innerWidth,innerHeight,setBrushExtent]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"rect\",{width:width,height:height,fill:\"white\"}),/*#__PURE__*/_jsxs(\"g\",{transform:`translate(${margin.left},${margin.top})`,children:[/*#__PURE__*/_jsx(AxisBottom,{xScale:xScale,innerHeight:innerHeight+5,tickFormat:d=>d}),/*#__PURE__*/_jsx(AxisLeft,{yScale:yScale,innerWidth:innerWidth}),/*#__PURE__*/_jsx(Marks,{data:data,xScale:xScale,yScale:yScale,xValue:d=>d.DayOrder// Reference DayOrder\n,yValue:yValue,circleRadius:2.5}),/*#__PURE__*/_jsx(\"g\",{ref:brushRef}),/*#__PURE__*/_jsx(\"text\",{className:\"axis-label\",textAnchor:\"middle\",transform:`translate(${innerWidth/2}, ${innerHeight+35})`,children:\"Days of the Week\"}),/*#__PURE__*/_jsx(\"text\",{className:\"axis-label\",textAnchor:\"middle\",transform:`translate(-25, ${innerHeight/2}) rotate(-90)`,children:\"HRV Score\"})]})]});};","map":{"version":3,"names":["scaleLinear","scaleBand","max","brushX","select","useRef","useEffect","AxisBottom","AxisLeft","Marks","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","margin","top","right","bottom","left","DateHistogram","_ref","data","width","height","setBrushExtent","innerHeight","innerWidth","xScale","domain","range","padding","yValue","d","HRV","yScale","nice","brushRef","brush","extent","current","on","event","selection","selectedDays","filter","day","dayPosition","children","fill","transform","tickFormat","xValue","DayOrder","circleRadius","ref","className","textAnchor"],"sources":["/Users/fmparantean/Documents/dataviz_project/src/DateHistogram/index.js"],"sourcesContent":["import {\n    scaleLinear,\n    scaleBand,\n    max,\n    brushX,\n    select\n} from 'd3';\nimport { useRef, useEffect } from 'react';\nimport { AxisBottom } from './AxisBottom';\nimport { AxisLeft } from './AxisLeft';\nimport { Marks } from './Marks';\n\nconst margin = { top: 20, right: 60, bottom: 50, left: 90 };\n\nexport const DateHistogram = ({\n    data,\n    width,\n    height,\n    setBrushExtent,\n}) => {\n    const innerHeight = height - margin.top - margin.bottom;\n    const innerWidth = width - margin.left - margin.right;\n\n    const xScale = scaleBand()\n        .domain([\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"])\n        .range([0, innerWidth])\n        .padding(0.1); // Adjust padding as necessary\n\n    const yValue = d => d.HRV; // Use HRV for y values\n    const yScale = scaleLinear()\n        .domain([-5, max(data, yValue) || 200]) // Ensure max returns a number\n        .range([innerHeight, 0])\n        .nice();\n\n    const brushRef = useRef();\n\n    useEffect(() => {\n        const brush = brushX().extent([[0, 0], [innerWidth, innerHeight]]);\n        brush(select(brushRef.current));\n        \n        brush.on('brush end', (event) => {\n            const selection = event.selection;\n            if (!selection) return;\n\n            // Get the selected domains based on brush selection\n            const selectedDays = xScale.domain().filter(day => {\n                const dayPosition = xScale(day);\n                return dayPosition >= selection[0] && dayPosition <= selection[1];\n            });\n\n            // Update the brush extent\n            setBrushExtent(selectedDays); \n        });\n    }, [innerWidth, innerHeight, setBrushExtent]);\n\n    return (\n        <>\n            <rect width={width} height={height} fill=\"white\" />\n            <g transform={`translate(${margin.left},${margin.top})`}>\n                <AxisBottom\n                    xScale={xScale}\n                    innerHeight={innerHeight + 5}\n                    tickFormat={d => d}\n                />\n                <AxisLeft\n                    yScale={yScale}\n                    innerWidth={innerWidth}\n                />\n                <Marks\n                    data={data}\n                    xScale={xScale}\n                    yScale={yScale}\n                    xValue={d => d.DayOrder}  // Reference DayOrder\n                    yValue={yValue}\n                    circleRadius={2.5}\n                />\n                <g ref={brushRef} />\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(${innerWidth / 2}, ${innerHeight + 35})`} \n                >\n                    Days of the Week\n                </text>\n                <text\n                    className=\"axis-label\"\n                    textAnchor=\"middle\"\n                    transform={`translate(-25, ${innerHeight / 2}) rotate(-90)`} \n                >\n                    HRV Score\n                </text>\n            </g>\n        </>\n    );\n};"],"mappings":"AAAA,OACIA,WAAW,CACXC,SAAS,CACTC,GAAG,CACHC,MAAM,CACNC,MAAM,KACH,IAAI,CACX,OAASC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CACzC,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,QAAQ,KAAQ,YAAY,CACrC,OAASC,KAAK,KAAQ,SAAS,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAEhC,KAAM,CAAAC,MAAM,CAAG,CAAEC,GAAG,CAAE,EAAE,CAAEC,KAAK,CAAE,EAAE,CAAEC,MAAM,CAAE,EAAE,CAAEC,IAAI,CAAE,EAAG,CAAC,CAE3D,MAAO,MAAM,CAAAC,aAAa,CAAGC,IAAA,EAKvB,IALwB,CAC1BC,IAAI,CACJC,KAAK,CACLC,MAAM,CACNC,cACJ,CAAC,CAAAJ,IAAA,CACG,KAAM,CAAAK,WAAW,CAAGF,MAAM,CAAGT,MAAM,CAACC,GAAG,CAAGD,MAAM,CAACG,MAAM,CACvD,KAAM,CAAAS,UAAU,CAAGJ,KAAK,CAAGR,MAAM,CAACI,IAAI,CAAGJ,MAAM,CAACE,KAAK,CAErD,KAAM,CAAAW,MAAM,CAAG5B,SAAS,CAAC,CAAC,CACrB6B,MAAM,CAAC,CAAC,QAAQ,CAAE,QAAQ,CAAE,SAAS,CAAE,WAAW,CAAE,UAAU,CAAE,QAAQ,CAAE,UAAU,CAAC,CAAC,CACtFC,KAAK,CAAC,CAAC,CAAC,CAAEH,UAAU,CAAC,CAAC,CACtBI,OAAO,CAAC,GAAG,CAAC,CAAE;AAEnB,KAAM,CAAAC,MAAM,CAAGC,CAAC,EAAIA,CAAC,CAACC,GAAG,CAAE;AAC3B,KAAM,CAAAC,MAAM,CAAGpC,WAAW,CAAC,CAAC,CACvB8B,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE5B,GAAG,CAACqB,IAAI,CAAEU,MAAM,CAAC,EAAI,GAAG,CAAC,CAAE;AAAA,CACvCF,KAAK,CAAC,CAACJ,WAAW,CAAE,CAAC,CAAC,CAAC,CACvBU,IAAI,CAAC,CAAC,CAEX,KAAM,CAAAC,QAAQ,CAAGjC,MAAM,CAAC,CAAC,CAEzBC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAiC,KAAK,CAAGpC,MAAM,CAAC,CAAC,CAACqC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC,CAAE,CAACZ,UAAU,CAAED,WAAW,CAAC,CAAC,CAAC,CAClEY,KAAK,CAACnC,MAAM,CAACkC,QAAQ,CAACG,OAAO,CAAC,CAAC,CAE/BF,KAAK,CAACG,EAAE,CAAC,WAAW,CAAGC,KAAK,EAAK,CAC7B,KAAM,CAAAC,SAAS,CAAGD,KAAK,CAACC,SAAS,CACjC,GAAI,CAACA,SAAS,CAAE,OAEhB;AACA,KAAM,CAAAC,YAAY,CAAGhB,MAAM,CAACC,MAAM,CAAC,CAAC,CAACgB,MAAM,CAACC,GAAG,EAAI,CAC/C,KAAM,CAAAC,WAAW,CAAGnB,MAAM,CAACkB,GAAG,CAAC,CAC/B,MAAO,CAAAC,WAAW,EAAIJ,SAAS,CAAC,CAAC,CAAC,EAAII,WAAW,EAAIJ,SAAS,CAAC,CAAC,CAAC,CACrE,CAAC,CAAC,CAEF;AACAlB,cAAc,CAACmB,YAAY,CAAC,CAChC,CAAC,CAAC,CACN,CAAC,CAAE,CAACjB,UAAU,CAAED,WAAW,CAAED,cAAc,CAAC,CAAC,CAE7C,mBACIb,KAAA,CAAAE,SAAA,EAAAkC,QAAA,eACItC,IAAA,SAAMa,KAAK,CAAEA,KAAM,CAACC,MAAM,CAAEA,MAAO,CAACyB,IAAI,CAAC,OAAO,CAAE,CAAC,cACnDrC,KAAA,MAAGsC,SAAS,CAAE,aAAanC,MAAM,CAACI,IAAI,IAAIJ,MAAM,CAACC,GAAG,GAAI,CAAAgC,QAAA,eACpDtC,IAAA,CAACJ,UAAU,EACPsB,MAAM,CAAEA,MAAO,CACfF,WAAW,CAAEA,WAAW,CAAG,CAAE,CAC7ByB,UAAU,CAAElB,CAAC,EAAIA,CAAE,CACtB,CAAC,cACFvB,IAAA,CAACH,QAAQ,EACL4B,MAAM,CAAEA,MAAO,CACfR,UAAU,CAAEA,UAAW,CAC1B,CAAC,cACFjB,IAAA,CAACF,KAAK,EACFc,IAAI,CAAEA,IAAK,CACXM,MAAM,CAAEA,MAAO,CACfO,MAAM,CAAEA,MAAO,CACfiB,MAAM,CAAEnB,CAAC,EAAIA,CAAC,CAACoB,QAAW;AAAA,CAC1BrB,MAAM,CAAEA,MAAO,CACfsB,YAAY,CAAE,GAAI,CACrB,CAAC,cACF5C,IAAA,MAAG6C,GAAG,CAAElB,QAAS,CAAE,CAAC,cACpB3B,IAAA,SACI8C,SAAS,CAAC,YAAY,CACtBC,UAAU,CAAC,QAAQ,CACnBP,SAAS,CAAE,aAAavB,UAAU,CAAG,CAAC,KAAKD,WAAW,CAAG,EAAE,GAAI,CAAAsB,QAAA,CAClE,kBAED,CAAM,CAAC,cACPtC,IAAA,SACI8C,SAAS,CAAC,YAAY,CACtBC,UAAU,CAAC,QAAQ,CACnBP,SAAS,CAAE,kBAAkBxB,WAAW,CAAG,CAAC,eAAgB,CAAAsB,QAAA,CAC/D,WAED,CAAM,CAAC,EACR,CAAC,EACN,CAAC,CAEX,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}